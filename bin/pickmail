#!/usr/bin/env python

import pickmail
import pprint

config = pickmail.Config()

parser = pickmail.Parser()
parser.parse_cli()

print parser.options
print parser.args

connection = pickmail.Connection(config)

offset = 0
selected = -1
while selected < 0:
    print connection.get_messages(offset) 
    msg = raw_input('Please select a message, or press return for more:\n')
    if msg == '':
        offset = offset + 10
        print connection.get_messages(offset=offset)
    else:
        selected = msg

if selected != '':
    data = connection.data
    uid = data[int(selected)]['uid']
    file = open('pickmail.out', 'w')
    file.write(connection.fetch_message(uid))
    file.close()
